table:
  name: DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS
  description: order items fact table
  dialect: snowflake
  casing-policy: preserve
  materialization: table
  purpose: model
  dependencies:
  - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS
  - DOUG_DEMO_V2.DBT_DGUTHRIE.PART_SUPPLIERS
  depended-on-by:
  - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT
  - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT
  - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES
  columns:
  - name: ORDER_ITEM_KEY
    description: surrogate key for the model -- combo of order_key + line_number
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ORDER_ITEM_KEY
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.ORDER_ITEM_KEY
  - name: ORDER_KEY
    description: foreign key for orders
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ORDER_KEY
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.ORDER_KEY
  - name: ORDER_DATE
    description: date of the order
    datatype: date
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ORDER_DATE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.ORDER_DATE
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.ORDER_YEAR
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'AIR'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'FOB'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'MAIL'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'RAIL'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'REG AIR'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'SHIP'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'TRUCK'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT.ORDER_YEAR
  - name: ORDER_DATE_PLUS_3_MONTHS
    datatype: date
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ORDER_DATE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.ORDER_DATE_PLUS_3_MONTHS
  - name: CUSTOMER_KEY
    description: foreign key for customers
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.CUSTOMER_KEY
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.CUSTOMER_KEY
  - name: PART_KEY
    description: foreign key for part
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.PART_KEY
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.PART_KEY
  - name: SUPPLIER_KEY
    description: foreign key for suppliers
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.SUPPLIER_KEY
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.SUPPLIER_KEY
  - name: ORDER_ITEM_STATUS_CODE
    description: status of the order item
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ORDER_ITEM_STATUS_CODE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.ORDER_ITEM_STATUS_CODE
  - name: RETURN_FLAG
    description: letter determining the status of the return
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.RETURN_FLAG
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.RETURN_FLAG
  - name: LINE_NUMBER
    description: sequence of the order items within the order
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.LINE_NUMBER
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.LINE_NUMBER
  - name: SHIP_DATE
    description: the date the order item is being shipped
    datatype: date
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.SHIP_DATE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.SHIP_DATE
  - name: COMMIT_DATE
    description: the date the order item is being commited
    datatype: date
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.COMMIT_DATE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.COMMIT_DATE
  - name: RECEIPT_DATE
    description: the receipt date of the order item
    datatype: date
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.RECEIPT_DATE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.RECEIPT_DATE
  - name: SHIP_MODE
    description: method of shipping
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.SHIP_MODE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.SHIP_MODE
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.AIR_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.FOB_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.MAIL_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.RAIL_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.REG_AIR_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.SHIP_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.TRUCK_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'AIR'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'FOB'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'MAIL'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'RAIL'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'REG AIR'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'SHIP'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'TRUCK'"
  - name: SUPPLIER_COST
    description: raw cost
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.PART_SUPPLIERS.COST
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.SUPPLIER_COST
  - name: BASE_PRICE
    description: since extended_price is the line item total, we back out the price per item
    datatype: decimal(16, 4)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.BASE_PRICE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.BASE_PRICE
  - name: DISCOUNT_PERCENTAGE
    description: percentage of the discount
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.DISCOUNT_PERCENTAGE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.DISCOUNT_PERCENTAGE
  - name: DISCOUNTED_PRICE
    description: factoring in the discount_percentage, the line item discount total
    datatype: decimal(16, 4)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.DISCOUNTED_PRICE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.DISCOUNTED_PRICE
  - name: TAX_RATE
    description: tax rate of the order item
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.TAX_RATE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.TAX_RATE
  - name: ORDER_ITEM_COUNT
    description: count of order items
    datatype: decimal(1, 0) not null
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.ORDER_ITEM_COUNT
  - name: QUANTITY
    description: total units
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.QUANTITY
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.QUANTITY
  - name: DISCOUNTED_ITEM_SALES_AMOUNT
    description: line item (includes quantity) discount amount
    datatype: decimal(16, 4)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.DISCOUNTED_ITEM_SALES_AMOUNT
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.DISCOUNTED_ITEM_SALES_AMOUNT
  - name: ITEM_DISCOUNT_AMOUNT
    description: item level discount amount. this is always a negative number
    datatype: decimal(16, 4)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ITEM_DISCOUNT_AMOUNT
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.ITEM_DISCOUNT_AMOUNT
  - name: ITEM_TAX_AMOUNT
    description: item level tax total
    datatype: decimal(16, 4)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ITEM_TAX_AMOUNT
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.ITEM_TAX_AMOUNT
  - name: NET_ITEM_SALES_AMOUNT
    description: the net total which factors in discount and tax
    datatype: decimal(16, 4)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.NET_ITEM_SALES_AMOUNT
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.NET_ITEM_SALES_AMOUNT
  - name: GROSS_ITEM_SALES_AMOUNT
    description: same as extended_price
    datatype: decimal(38, 0)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.GROSS_ITEM_SALES_AMOUNT
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.USE_VARIABLES.GROSS_ITEM_SALES_AMOUNT
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.AIR_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.FOB_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.MAIL_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.RAIL_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.REG_AIR_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.SHIP_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT.TRUCK_amount
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'AIR'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'FOB'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'MAIL'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'RAIL'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'REG AIR'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'SHIP'"
      - DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_HARDCODED_PIVOT."'TRUCK'"
  lineage:
    scan:
    - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ORDER_DATE
    - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.PART_KEY
    - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.SUPPLIER_KEY
    - DOUG_DEMO_V2.DBT_DGUTHRIE.PART_SUPPLIERS.PART_KEY
    - DOUG_DEMO_V2.DBT_DGUTHRIE.PART_SUPPLIERS.SUPPLIER_KEY
  source-locations:
  - path: target/compiled/sdf/models/DOUG_DEMO_V2/DBT_DGUTHRIE/fct_order_items.sdf.yml
  - path: target/compiled/sdf/models/DOUG_DEMO_V2/DBT_DGUTHRIE/fct_order_items.sql
