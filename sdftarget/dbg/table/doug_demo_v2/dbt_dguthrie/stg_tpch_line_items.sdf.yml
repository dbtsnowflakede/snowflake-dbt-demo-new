table:
  name: DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_LINE_ITEMS
  description: staging layer for line items data
  dialect: snowflake
  casing-policy: preserve
  materialization: view
  purpose: model
  dependencies:
  - DOUG_DEMO_V2.TPCH.LINEITEM
  depended-on-by:
  - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS
  columns:
  - name: ORDER_ITEM_KEY
    description: surrogate key for the model -- combo of order_key + line_number
    datatype: varchar
    lineage:
      modify:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_LINENUMBER
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_ORDERKEY
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ORDER_ITEM_KEY
  - name: ORDER_KEY
    description: foreign key to stg_tpch_orders
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_ORDERKEY
  - name: PART_KEY
    description: foreign key to stg_tpch_part_suppliers
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_PARTKEY
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.PART_KEY
  - name: SUPPLIER_KEY
    description: foreign key to stg_tpch_suppliers
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_SUPPKEY
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.SUPPLIER_KEY
  - name: LINE_NUMBER
    description: sequence of the order items within the order
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_LINENUMBER
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.LINE_NUMBER
  - name: QUANTITY
    description: total units
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_QUANTITY
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.QUANTITY
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.BASE_PRICE
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.DISCOUNTED_PRICE
  - name: EXTENDED_PRICE
    description: line item price
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_EXTENDEDPRICE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.EXTENDED_PRICE
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.GROSS_ITEM_SALES_AMOUNT
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.BASE_PRICE
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.DISCOUNTED_ITEM_SALES_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.DISCOUNTED_PRICE
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ITEM_DISCOUNT_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ITEM_TAX_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.NET_ITEM_SALES_AMOUNT
  - name: DISCOUNT_PERCENTAGE
    description: percentage of the discount
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_DISCOUNT
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.DISCOUNT_PERCENTAGE
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.DISCOUNTED_ITEM_SALES_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.DISCOUNTED_PRICE
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ITEM_DISCOUNT_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ITEM_TAX_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.NET_ITEM_SALES_AMOUNT
  - name: TAX_RATE
    description: tax rate of the order item
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_TAX
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.TAX_RATE
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ITEM_TAX_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.NET_ITEM_SALES_AMOUNT
  - name: RETURN_FLAG
    description: letter determining the status of the return
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_RETURNFLAG
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.RETURN_FLAG
  - name: STATUS_CODE
    description: status code of the order item
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_LINESTATUS
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ORDER_ITEM_STATUS_CODE
  - name: SHIP_DATE
    description: the date the order item is being shipped
    datatype: date
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_SHIPDATE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.SHIP_DATE
  - name: COMMIT_DATE
    description: the date the order item is being commited
    datatype: date
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_COMMITDATE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.COMMIT_DATE
  - name: RECEIPT_DATE
    description: the receipt date of the order item
    datatype: date
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_RECEIPTDATE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.RECEIPT_DATE
  - name: SHIP_INSTRUCTIONS
    description: additional instructions on the shipment
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_SHIPINSTRUCT
  - name: SHIP_MODE
    description: method of shipping
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_SHIPMODE
    forward-lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.SHIP_MODE
  - name: COMMENT
    description: additional commentary
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.TPCH.LINEITEM.L_COMMENT
  source-locations:
  - path: target/compiled/sdf/models/DOUG_DEMO_V2/DBT_DGUTHRIE/stg_tpch_line_items.sdf.yml
  - path: target/compiled/sdf/models/DOUG_DEMO_V2/DBT_DGUTHRIE/stg_tpch_line_items.sql
