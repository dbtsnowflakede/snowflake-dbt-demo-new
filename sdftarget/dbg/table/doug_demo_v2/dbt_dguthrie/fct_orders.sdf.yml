table:
  name: DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDERS
  description: orders fact table
  dialect: snowflake
  casing-policy: preserve
  materialization: table
  purpose: model
  dependencies:
  - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS
  - DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_ORDERS
  depended-on-by:
  - DOUG_DEMO_V2.DBT_DGUTHRIE.TOTAL_REVENUE
  columns:
  - name: ORDER_KEY
    description: primary key of the model
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_ORDERS.ORDER_KEY
  - name: ORDER_DATE
    description: date of the order
    datatype: date
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_ORDERS.ORDER_DATE
    forward-lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.TOTAL_REVENUE.DATE_MONTH
  - name: CUSTOMER_KEY
    description: foreign key for customers
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_ORDERS.CUSTOMER_KEY
  - name: STATUS_CODE
    description: status of the order
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_ORDERS.STATUS_CODE
  - name: PRIORITY_CODE
    description: code associated with the order
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_ORDERS.PRIORITY_CODE
  - name: SHIP_PRIORITY
    description: numeric representation of the shipping priority, zero being the default
    datatype: decimal(38, 0)
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_ORDERS.SHIP_PRIORITY
  - name: CLERK_NAME
    description: id of the clerk
    datatype: varchar
    lineage:
      copy:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_ORDERS.CLERK_NAME
  - name: ORDER_COUNT
    description: count of order
    datatype: decimal(1, 0) not null
  - name: GROSS_ITEM_SALES_AMOUNT
    description: same as extended_price
    datatype: decimal(38, 0)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.GROSS_ITEM_SALES_AMOUNT
    forward-lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.TOTAL_REVENUE.TOTAL_REVENUE
  - name: ITEM_DISCOUNT_AMOUNT
    description: item level discount amount. this is always a negative number
    datatype: decimal(28, 4)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ITEM_DISCOUNT_AMOUNT
  - name: ITEM_TAX_AMOUNT
    description: item level tax total
    datatype: decimal(28, 4)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ITEM_TAX_AMOUNT
  - name: NET_ITEM_SALES_AMOUNT
    description: the net total which factors in discount and tax
    datatype: decimal(28, 4)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.NET_ITEM_SALES_AMOUNT
  lineage:
    scan:
    - DOUG_DEMO_V2.DBT_DGUTHRIE.ORDER_ITEMS.ORDER_KEY
    - DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_ORDERS.ORDER_DATE
    - DOUG_DEMO_V2.DBT_DGUTHRIE.STG_TPCH_ORDERS.ORDER_KEY
  source-locations:
  - path: target/compiled/sdf/models/DOUG_DEMO_V2/DBT_DGUTHRIE/fct_orders.sdf.yml
  - path: target/compiled/sdf/models/DOUG_DEMO_V2/DBT_DGUTHRIE/fct_orders.sql
