table:
  name: DOUG_DEMO_V2.DBT_DGUTHRIE.AGG_SHIP_MODES_DYNAMIC_PIVOT
  description: Example of creating a pivot table with hard-coded columns based on a query of the ship modes that are in the system
  dialect: snowflake
  casing-policy: preserve
  materialization: view
  purpose: model
  dependencies:
  - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS
  columns:
  - name: ORDER_YEAR
    description: year of the order
    datatype: decimal(9, 0)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.ORDER_DATE
  - name: FOB_amount
    datatype: decimal(38, 0)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.GROSS_ITEM_SALES_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.SHIP_MODE
  - name: TRUCK_amount
    datatype: decimal(38, 0)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.GROSS_ITEM_SALES_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.SHIP_MODE
  - name: AIR_amount
    datatype: decimal(38, 0)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.GROSS_ITEM_SALES_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.SHIP_MODE
  - name: REG_AIR_amount
    datatype: decimal(38, 0)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.GROSS_ITEM_SALES_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.SHIP_MODE
  - name: MAIL_amount
    datatype: decimal(38, 0)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.GROSS_ITEM_SALES_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.SHIP_MODE
  - name: SHIP_amount
    datatype: decimal(38, 0)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.GROSS_ITEM_SALES_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.SHIP_MODE
  - name: RAIL_amount
    datatype: decimal(38, 0)
    lineage:
      modify:
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.GROSS_ITEM_SALES_AMOUNT
      - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.SHIP_MODE
  lineage:
    scan:
    - DOUG_DEMO_V2.DBT_DGUTHRIE.FCT_ORDER_ITEMS.ORDER_DATE
  source-locations:
  - path: target/compiled/sdf/models/DOUG_DEMO_V2/DBT_DGUTHRIE/agg_ship_modes_dynamic_pivot.sdf.yml
  - path: target/compiled/sdf/models/DOUG_DEMO_V2/DBT_DGUTHRIE/agg_ship_modes_dynamic_pivot.sql
